'use strict';

const React = require('react');
const jQuery = require('jQuery');


const Video = React.createClass({

  componentWillMount: function() {
    console.log('componentWillMount', ': ', this.props.title);
  },
  componentWillUpdate: function() {
    // console.log('componentWillUpdate',': ', nextProps, nextState);
  },
  componentDidMount: function() {
    console.log('componentDidMount', 'id:', this.refs.videoContainer.props.id);

    // @TODO4: check kaltura library is only loaded once
    // Note: if you want to the component to be fully self containing one has to accept that the kaltura player library for one player can be loaded several times (e.g. as many times as a certain player occurs in a page)

    var props = this.props;
    jQuery.getScript( "http://cdnapi.kaltura.com/p/1719221/sp/171922100/embedIframeJs/uiconf_id/"+props.playerID+"/partner_id/1719221", function( data, textStatus ) {
      // console.log("Kaltura player js was loaded.");

      if (textStatus === "success") {
        var config = {
          'targetId': props.kalturaID,
          'wid': '_1719221',
          'uiconf_id': props.playerID,
          'entry_id': props.kalturaID,
          'flashvars': {
            'EmbedPlayer.EnableFullscreen': false
          }
        };
        kWidget.embed(config);
        console.log('Embedding Kaltura player', config);
      }

    });

  },
  render() {
    return (
      <div className="video" ref="videoContainer" id={this.props.kalturaID} ></div>
    );
  }

});

module.exports = Video;

