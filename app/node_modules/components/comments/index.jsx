import React from 'react';
import bem from 'react-bem-helper';

import { getScript } from 'helpers';
import Button from 'components/button';

const classes = new bem({
  name: 'comments',
  prefix: ''
});

const DISQUS_SHORTNAME = process.env.DISQUS_SHORTNAME || 'azmedien-staging';

export default React.createClass({

  displayName: 'Comments',

  getInitialState() {
    return {
      loaded: false
    };
  },

  loadDisqus() {
    getScript(
      '//' + DISQUS_SHORTNAME + '.disqus.com/embed.js',
      this.setState({ loaded: true })
    );
  },

  render() {
    return (
      <section ref='comments' {...classes()}>
        {this.state.loaded
          ? <div id='disqus_thread'></div>
          : <Button _event={this.loadDisqus} {...classes('btn')} modifier='huge' label='Kommentare anzeigen' />
        }
      </section>
    );

  }

});
