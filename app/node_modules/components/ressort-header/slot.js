var _ = require('lodash');
var capitalizeAll = require('helpers/capitalize');

var mapNavigation = function(state) {
  var ressort = state.ressort;
  var subressort = state.subressort;

  if (!state.navigation) {
    return [];
  }

  return state.navigation.map(function(item) {
    var href = '/' + _.get(ressort, 'urlpart') + '/' + item.urlpart;
    return {
      label: capitalizeAll(item.title),
      href: href,
      active: _.get(subressort, 'urlpart') === item.urlpart
    };
  });
};

var parsedData = function(state) {

  var ressort = state.ressort;
  var subressort = state.subressort;

  return {
    title: capitalizeAll(_.get(subressort || ressort, 'title')),
    navigation: mapNavigation(state)
  };

};

module.exports = {
  iso: false,
  data: parsedData
};
