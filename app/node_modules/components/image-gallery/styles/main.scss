@import 'globals';
@import 'utilities/variables';


/**
 * Gallery element itself
 * 1. Wider version doesn't show edges of other slides
 */
.image-gallery {
  position: relative;

  @include media('>#{$image-gallery-breakpoint}') {
    overflow: hidden; /* 1 */
  }
}

/**
 * Flickity slider setup
 * 1. Will use padding to set height of slider responsively,
 * plus height of caption (as images are absolute so zero height)
 */
.image-gallery .flickity-viewport {
  position: relative;
  box-sizing: content-box; /* 1 */
}

.image-gallery .flickity-slider {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
}


/**
 * Gallery element itself
 * 1. As it overlaps the image responsively, disallow pointer clicks
 * so the user can right-click the image
 */
.image-gallery__nav {
  position: absolute;
  top: 0;
  right: 0;
  left: 0;
  pointer-events: none; /* 1 */
}


/**
* Padding-box hack for aspect ratio
* See: http://andyshora.com/css-image-container-padding-hack.html
*/
.image-gallery__nav,
.image-gallery__nav::before,
.image-gallery .flickity-viewport,
.image-gallery .responsive-image::before {
  $width: nth($image-gallery-ratio, 1);
  $height: nth($image-gallery-ratio, 2);

  padding-bottom: (($height / $width) * 100%);
}

/**
 * Slider background
 * 1. Show behind the images
 */
.image-gallery__nav::before {
  content: '';
  background-color: $letterbox-background;
  position: absolute;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: -1; /* 1 */
}

/**
 * Grid wrapper
 * 1. Show above the background
 */
.image-gallery__grid {
  position: relative;
  z-index: 1; /* 1 */
}

/**
 * Grid items
 */
.image-gallery__item {
  width: 100%;
}

/**
 * Push the captio down the same height as the nav bar
 */
.image-gallery__item .caption {
  margin-top: $slider-nav-bar-height; /* 1 */
}

/**
 * Navigation bar
 * 1. Above images to hide rounding errors
 */
.image-gallery__nav-bar {
  position: absolute;
  z-index: 3; /* 1 */
  top: 100%;
  right: 0;
  left: 0;
  padding-left: 12px;
  font-family: $supporting-font-stack;
  font-size: 0.9em;
  background: $light-grey;
  color: $medium-grey;
  line-height: $slider-nav-bar-height;
}

/**
 * Fullscreen button
 */
.image-gallery__fullscreen {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  width: 40px;
  background-color: transparent;
  cursor: pointer;
  pointer-events: auto; /* 2 */
  z-index: 2;
  outline: 0;

  /**
   * Size and position for open icon
   */
  .icon {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    height: 16px;
    width: 16px;
  }
}

/**
 * Previous / Next buttons
 * 1. On top of gallery
 * 2. Allow clicks
 * 3. Hide button when we reach the first/last slide
 * 4. Remove action indicator
 */
.image-gallery__button {
  position: absolute;
  top: 0;
  bottom: 0;
  width: $slider-nav-button-width;
  z-index: 2; /* 1 */
  pointer-events: auto; /* 2 */
  outline: 0;

  /**
   * Color, size amd position for chevrons
   */
  .icon {
    fill: white;
    width: $slider-nav-button-width;
    height: $slider-nav-button-width;
    position: absolute;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
  }

  &.is-hidden {
    opacity: 0; /* 3 */
    cursor: auto; /* 4 */
  }
}

.is-gallery-loading .image-gallery__button,
.is-gallery-loading .caption,
.is-gallery-loading .image-gallery__slide-number {
  opacity: 0;
}

/**
 * Previous button
 */
.image-gallery__button--prev {
  left: 0;
  background: linear-gradient(to right, rgba(black, 0.5), transparent);
}

/**
 * Next button
 */
.image-gallery__button--next {
  right: 0;
  background: linear-gradient(to left, rgba(black, 0.5), transparent);
}


/**
 * Hover interactions
 */
.image-gallery__nav .icon, {
  opacity: 0.75;
  transition: 0.2s ease;
}

.image-gallery__button,
.image-gallery__fullscreen {
  @include on-interaction {
    .icon {
      opacity: 1;
    }
  }
}

/**
 * Hide elements when gallery is loading
 */
.image-gallery__button,
.image-gallery__fullscreen,
.caption,
.image-gallery__slide-number {
  transition: 0.2s ease;

  .is-gallery-loading & {
    opacity: 0;
  }
}
