var DomainVariations = require('config/domain-variations');
var NavItems = require('config/nav-items');

var mappedNavItems = function(skin, items) {
  if (skin in DomainVariations) {
    items.splice(1, 0, {
      href: DomainVariations[skin].href,
      label: DomainVariations[skin].label
    });
  }
  return items;
};

var getActiveSection = function(path) {
  var segments = path.match(/\/(\w|-)+/g);
  return segments.length > 2 ? segments[0] : '/';
};

var parsedData = function(state) {
  var navItems = NavItems.slice();

  return {
    skin: state.skin,
    nav: {
      active: getActiveSection(state.path),
      items: mappedNavItems(state.skin, navItems)
    }
  };
};

module.exports = {
  iso: true,
  data: parsedData
};
