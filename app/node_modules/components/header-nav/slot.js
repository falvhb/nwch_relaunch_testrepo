var DomainVariations = require('config/domain-variations');
var NavItems = require('config/nav-items');

module.exports = function(state) {

  var mappedNavItems = function(skin, items) {
    if (skin in DomainVariations) {
      items.splice(1, 0, {
        href: DomainVariations[skin].href,
        label: DomainVariations[skin].label
      });
    }
    return items;
  };

  var getActiveSection = function(path) {
    var segments = path.match(/\/(\w|-)+/g);
    return segments.length > 2 ? segments[0] : '/';
  };

  var parsedData = function(data) {
    var navItems = NavItems.slice();

    return {
      skin: data.skin,
      path: data.path,
      nav: {
        active: getActiveSection(data.path),
        items: mappedNavItems(data.skin, navItems)
      }
    };
  };

  return parsedData(state);

};
