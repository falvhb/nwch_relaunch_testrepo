import React from 'react/addons';
const TestUtils = React.addons.TestUtils;

import ResponsiveImage from 'components/responsive-image';
import variations from 'components/responsive-image/.variations';

const data = variations[2].data;
const lazyData = variations[4].data;

import { expect } from 'chai';

describe('Responsive Image', function() {

  var image, lazyImage;

  beforeEach(function() {
    image = TestUtils.renderIntoDocument(
      <ResponsiveImage {...data} />
    );

    lazyImage = TestUtils.renderIntoDocument(
      <ResponsiveImage {...lazyData} />
    );
  });

  describe('creates', function() {
    it('correct goldbach signature for normal images', function() {
      const signature = image.createImageSignature({
        width: 100,
        height: 200,
        salt: 'goldbach_7327'
      });
      expect(signature).to.equal('sA5_9xmYnbfVhNNEumV5LWIQbZc/100x200');
    });

    it('correct goldbach signature for letterbox images', function() {
      const signature = image.createImageSignature({
        width: 100,
        height: 200,
        letterbox: true,
        salt: 'goldbach_7327'
      });
      expect(signature).to.equal('Xvab_iFD_lZ-FyfgR5fadpR7S9w/100x200,fill');
    });

    it('correct aspect ratio', function() {
      const dimensions = image.imageDimensionsForSize('small', '4x3');
      expect(dimensions.width).to.equal(320);
      expect(dimensions.height).to.equal(240);
    });

    it('correct image src', function() {
      expect(image.state.src).to.equal('http://static.azbe.lovelysystems.com/__ip/VkB99wpVQlfPHPT1vJq72klt0Bk/30420d1a9afb2bcb60335812569af4435a59ce17/remote.adjust.rotate=0&remote.size.w=1024&remote.size.h=768&local.crop.h=292&local.crop.w=512&local.crop.x=512&local.crop.y=91,teaser-goldbach/k9iJNfT4QTQIC2I6-yXlP3JngnE/650x366');
      expect(lazyImage.state.src).to.equal('http://static.azbe.lovelysystems.com/__ip/VkB99wpVQlfPHPT1vJq72klt0Bk/30420d1a9afb2bcb60335812569af4435a59ce17/remote.adjust.rotate=0&remote.size.w=1024&remote.size.h=768&local.crop.h=292&local.crop.w=512&local.crop.x=512&local.crop.y=91,teaser-goldbach/soFMUC_xsAxsvrXW1oMwfp_a3hQ/850x479');
    });

    it('loading state', function() {
      expect(image.state.loading).to.equal(true);
    });

    it('adds support flag', function() {
      expect(image.state.support).to.equal(true);
    });
  });
});
