import React from 'react/addons';
const TestUtils = React.addons.TestUtils;

import ResponsiveImage from 'components/responsive-image';
import variations from 'components/responsive-image/.variations';

const data = variations[4].data;
const lazyData = variations[7].data;

import { expect } from 'chai';

describe('Responsive Image', function() {

  var image, lazyImage;

  beforeEach(function() {
    image = TestUtils.renderIntoDocument(
      <ResponsiveImage {...data} />
    );

    lazyImage = TestUtils.renderIntoDocument(
      <ResponsiveImage {...lazyData} />
    );
  });

  describe('creates', function() {
    it('correct goldbach signature', function() {
      const signature = image.createImageSignature({
        width: 100,
        height: 200,
        fill: true,
        salt: 'goldbach_7327'
      });
      expect(signature).to.equal('Xvab_iFD_lZ-FyfgR5fadpR7S9w/100x200,fill');
    });

    it('correct aspect ratio', function() {
      const dimensions = image.imageDimensionsForSize('small', '4x3');
      expect(dimensions.width).to.equal(320);
      expect(dimensions.height).to.equal(240);
    });

    it('correct image src', function() {
      expect(image.state.src).to.equal('http://static.azbe.lovelysystems.com/__ip/VkB99wpVQlfPHPT1vJq72klt0Bk/30420d1a9afb2bcb60335812569af4435a59ce17/remote.adjust.rotate=0&remote.size.w=1024&remote.size.h=768&local.crop.h=292&local.crop.w=512&local.crop.x=512&local.crop.y=91,teaser-goldbach/u_AgA5a3P9HwZj00cMQOa336MCg/960x540');
      expect(lazyImage.state.src).to.equal('http://static.azbe.lovelysystems.com/__ip/VkB99wpVQlfPHPT1vJq72klt0Bk/30420d1a9afb2bcb60335812569af4435a59ce17/remote.adjust.rotate=0&remote.size.w=1024&remote.size.h=768&local.crop.h=292&local.crop.w=512&local.crop.x=512&local.crop.y=91,teaser-goldbach/u_AgA5a3P9HwZj00cMQOa336MCg/960x540');
    });

    it('loading state', function() {
      expect(image.state.loading).to.equal(true);
    });

    it('adds support flag', function() {
      expect(image.state.support).to.equal(true);
    });
  });
});
