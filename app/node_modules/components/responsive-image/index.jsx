'use strict';

const React = require('react');
const CryptoJS = require('crypto-js');
const path = require('path');

const IMAGE_SALT = 'FyfgR5fadpR7S9w';

const ResponsiveImage = React.createClass({

  urlEncode(str) {
    return str.replace(/\=$/, '').replace(/\+/g, '-').replace(/\//g, '_').replace(/\=+$/, '');
  },

  createImageSignature(width, height) {
    var size = '/'.concat(width, 'x', height, ',fill');
    var signature = CryptoJS.HmacSHA1(size, IMAGE_SALT);
    var encodedSignature = this.urlEncode(CryptoJS.enc.Base64.stringify(signature));
    return path.join(encodedSignature, size);
  },

  createImageSrc(src, width, height) {
    return src + '/' + this.createImageSignature(width, height);
  },

  render() {

    var image = this.props.teaserImageBaseURL;

    return (
      <div>
        <img src={this.createImageSrc(image, 500, 500)}/>
      </div>
    );
  }

});

module.exports = ResponsiveImage;
