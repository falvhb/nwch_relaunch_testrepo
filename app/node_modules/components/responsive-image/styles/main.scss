@import 'globals';
@import 'utilities/variables';

/**
 * Responsive image
 */
.responsive-image {
  display: block;
  position: relative;
  overflow: hidden;
  background: $light-grey;

  &.is-failed {
    height: 0;
  }

  /**
   * Padding-box hack to preserve ratio
   * See: http://andyshora.com/css-image-container-padding-hack.html
   */
  &::before {
    content: '';
    display: block;
  }

  &::after {
    opacity: 0;
  }
}


/**
 * Responsive image while loading
 */
.responsive-image {
  @include loading-spinner;
}

/**
 * Responsive image when loaded
 */
.responsive-image.is-loaded {
  &::after {
    display: none;
  }
}


/*
 * Responsive image when failed
 */
.responsive-image.is-failed {
  background: $light-grey;
}

@each $ratio in $image-ratios {
  $width: nth($ratio, 1);
  $height: nth($ratio, 2);

  /**
   * Padding-box hack to preserve ratio
   * See: http://andyshora.com/css-image-container-padding-hack.html
   */
  .responsive-image--#{$width}x#{$height}::before {
    padding-bottom: (($height / $width) * 100%);
  }
}

/**
 * Actual image element
 */
.responsive-image__img {
  transition: opacity $image-transition;
  backface-visibility: hidden;

  .is-loading &,
  .is-failed &,
  &[data-flickity-lazyload] {
    opacity: 0;
  }
}

/**
 * <noscript> images
 */
.responsive-image--fallback .responsive-image__img {
  max-width: 100%;
}

/**
 * Images where we do some sizing
 */
.responsive-image--fill .responsive-image__img,
.responsive-image--letterbox .responsive-image__img {
  position: absolute;
  z-index: 2;
}

/**
 * Cropped images (no height given)
 */
.responsive-image--fill .responsive-image__img {
  width: 100%;
  top: 50%;
  left: 0;
  transform: translateY(-50%);
}

/**
 * Letterbox images
 */
.responsive-image--letterbox,
.responsive-image--letterbox.is-loading {
  background-color: $letterbox-background;
}

/**
 * Centered within container
 */
.responsive-image--letterbox .responsive-image__img {
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  max-width: 100%;
  max-height: 100%;
}
