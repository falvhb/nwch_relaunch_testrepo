import React from 'react';
import Button from 'components/button';
import isLoggedIn from 'helpers/dashboard/is-logged-in';

export default React.createClass({

  displayName: 'LoginButton',

  componentDidMount: function() {
    this.setState({
      browser: true,
      isLoggedIn: isLoggedIn()
    });
  },

  getInitialState: () => ({
    browser: false,
    isLoggedIn: false
  }),

  render() {
    let loginURL = '/anmelden';

    if (this.state.browser) {
      loginURL += '?redirectTo=' + encodeURIComponent(document.location.href);
    }

    if (this.state.isLoggedIn) {
      return (
        <Button icon='user' url="/dashboard/profil" label="Mein Profil" modifier="meta"/>
      );
    }
    return (
      <Button icon='user' url={loginURL} label="Anmelden" modifier="meta" attributes={{'title': 'Anmelden'}} />
    );
  }
});
