import React from 'react';
import bem from 'react-bem-helper';
import Icon from 'components/icon';
import { capitalize } from 'lodash/string';

const classes = new bem('ugc-header');

export default React.createClass({

  displayName: 'UGCHeader',

  propTypes: {
    type: React.PropTypes.oneOf(['leserbeitrag', 'vereinsmeldung', 'sportverein', 'gemeindebeitrag']).isRequired,
    city: React.PropTypes.shape({
      name: React.PropTypes.string.isRequired,
      url: React.PropTypes.string.isRequired,
      shield_url: React.PropTypes.string
    }),
    author: React.PropTypes.shape({
      name: React.PropTypes.string.isRequired,
      url: React.PropTypes.string.isRequired,
      image: React.PropTypes.string
    })
  },

  nameForType(type) {
    return capitalize({
      sportverein: 'sportvereinsmeldung',
    }[type] || type)
  },

  renderCity() {
    var { name, image, url } = this.props.city;

    return (
      <span key='city' {...classes('block')} itemProp="contentLocation">
        <a href={url}>
          <span {...classes('text')} >
            { 'aus ' }
            <span {...classes('link')} itemProp="name"> { name }</span>
          </span>
          <img itemProp="logo" src={ image } alt="" {...classes('avatar', 'city')} />
        </a>
      </span>
    )
  },

  renderClub() {
    var { name, image, url } = this.props.club;
    return (
      <span key='club' {...classes('block')} itemProp="subject">
        <a href={url}>
          <span {...classes('text')} >
            <span {...classes('link')} itemProp="name"> { name }</span>
          </span>
          <img itemProp="image" src={ image } alt="" {...classes('avatar', 'author')} />
        </a>
      </span>
    )
  },

  renderAuthor() {
    var { name, image, url } = this.props.author;

    return (
      <span key='author' {...classes('block')} itemProp="author">
        <a href={url}>
          <span {...classes('text')} >
            { 'von ' }
            <span {...classes('link')} itemProp="name"> { name }</span>
          </span>
          <img itemProp="image" src={ image } alt="" {...classes('avatar', 'author')} />
        </a>
      </span>
    )
  },

  render() {
    var { type } = this.props;

    if (!type) {
      return null;
    }

    var items = [
      <Icon {...classes('icon')} key='icon' id='megaphone' />,
      this.nameForType(type) + ' ',
    ];

    switch (type) {
      case 'leserbeitrag':
        items.push(this.renderAuthor(), this.renderCity())
        break;
      case 'gemeindebeitrag':
        items.push(this.renderCity(), this.renderAuthor())
        break;
      case 'vereinsmeldung':
      case 'sportverein':
        items.push(this.renderClub(), this.renderAuthor())
        break;
    }

    return (
      <div {...classes({ extra: 'type-detail'})}>
        { items }
      </div>
    );
  }
});
