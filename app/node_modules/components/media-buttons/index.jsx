import React from 'react';
import bem from 'react-bem-helper';

import Button from 'components/button';

const classes = new bem({
  name: 'media-buttons',
  prefix: ''
});

export default React.createClass({

  url: null,

  propTypes: {
    title: React.PropTypes.string,
    description: React.PropTypes.string
  },

  componentDidMount() {
    this.url = window.location.href;
    this.setState({
      support: true
    });
  },

  getInitialState() {
    return {
      support: false
    };
  },

  print() {
    window.print();
  },

  getTwitterTarget() {
    return 'http://www.twitter.com/share'
      + '?url=' + this.url
      + '&text=' + this.props.title;
  },

  getFacebookTarget() {
    return 'http://www.facebook.com/sharer/sharer.php'
      + '?u=' + this.url;
  },

  getMailTarget() {
    var target = 'mailto:?subject=__SUBJECT__&body=__BODY__'
      .replace('__SUBJECT__', this.props.title)
      .replace('__BODY__', this.props.description);

    if (this.url) {
      target += ' ' + this.url;
    }
  },

  render() {

    var attributes = {
      target: '_blank'
    };

    return (
      <div {...classes()}>
        {this.url
          ? <Button icon='facebook' _target={this.getFacebookTarget()} attributes={attributes} />
          : ''}

        {this.url
          ? <Button icon='twitter' _target={this.getTwitterTarget()} attributes={attributes} />
          : ''}

        {this.props.title && this.props.description
          ? <Button icon='mail' _target={this.getMailTarget()} />
          : ''}

        {this.state.support
          ? <Button icon='print' _target={this.print} />
          : ''}
      </div>
    );

  }

});
