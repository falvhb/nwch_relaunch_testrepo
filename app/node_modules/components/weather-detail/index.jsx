import React from 'react';
import BEM from 'react-bem-helper';

import Section from 'components/section';
import SectionHeader from 'components/section-header';
import Container from 'components/container';
import WeatherForecast from 'components/weather-forecast';

const classes = new BEM({
  name: 'weather-detail',
  prefix: ''
});

export default React.createClass({

  displayName: 'WeatherDetail',

  propTypes: {
    weatherIcon: React.PropTypes.string.isRequired,
    minTemperature: React.PropTypes.number.isRequired,
    maxTemperature: React.PropTypes.number.isRequired,
    weatherText: React.PropTypes.string.isRequired
  },

  getInitialState() {
    return this.state = {
      parish: this.props.parishes[0].name
    };
  },

  select(event) {
    this.setState({parish: event.target.value});
  },

  render() {

    let parishes = this.props.parishes;

    let options = parishes.map((item, index) => {
      return <option value={item.name} key={index}>{item.name}</option>;
    });

    let forecast = parishes.map((item, index) => {
      let output;
      if (item.name === this.state.parish) {
        output = (
          <div {...classes()}>
            <div  {...classes('data')}>
              <WeatherForecast
                key={index}
                weatherIcon={item.weatherIcon}
                minTemperature={item.minTemperature}
                maxTemperature={item.maxTemperature}
              />
            </div>
            <div {...classes('text')}>
              {item.weatherText}
            </div>
          </div>
        );
      }
      return output;
    });

    return (

      <Section modifier='default'>
        <Container>
          <SectionHeader title='Gemeinde Ã¤ndern:' />
          <select
            {...classes('dropdown')}
            onChange={this.select}
            value={this.state.parish}
          >
            {options}
          </select>
          {forecast}
        </Container>
      </Section>
    );
  }
});
