var slugify = require('slugify');
var getMainAsset = require('helpers/get-main-asset');

module.exports = function(state) {

  var parseDateString = function(article, variation) {
    return variation ? article.dc.created : '';
  };

  var createUrl = function(article) {
    var url = '/';
    url += (article.ressorts[0].parent ? article.ressorts[0].parent.urlpart + '/' : '');
    url += article.ressorts[0].urlpart + '/';
    url += slugify(article.title) + '-';
    url += article.id;
    return url;
  };

  var parsedData = function(props) {
    var article = props.article;
    var mainAsset = getMainAsset(article.assets);

    return {
      modifier: props.variation,
      title: article.title,
      catchword: article.context_label,
      supplementary: parseDateString(article, props.variation),
      asset: (props.variation === 'light' || props.variation === 'light-boxed' ? null : mainAsset),
      url: createUrl(article)
    };
  };

  return parsedData(state);

};
