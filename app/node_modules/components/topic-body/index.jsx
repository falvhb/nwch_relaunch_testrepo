import React from 'react';
import bem from 'react-bem-helper';

import Wrapper from './wrapper';

import Teaser from 'components/teaser';

const classes = new bem({
  name: 'topic-body',
  prefix: ''
});

const TopicBody = React.createClass({

  displayName: 'TopicBody',

  propTypes: {
    articles: React.PropTypes.arrayOf(React.PropTypes.object)
  },

  defaultShowing: 12,

  getInitialState() {
    return {
      showing: this.defaultShowing
    };
  },

  sliceResults(articles, count) {
    return articles.slice(0, count);
  },

  loadMore() {
    this.setState({
      showing: this.state.showing + this.defaultShowing
    });
  },

  render() {

    var { articles } = this.props;
    var { showing } = this.state;
    var needsPagination = articles.length > showing;

    return (
      <div {...classes()}>
        <div {...classes('grid')}>
          {this.sliceResults(articles, showing).map((article, index) => {
            return (
              <div {...classes('cell')} key={index}>
                <Teaser key={index} {...article} modifier='basic' />
              </div>
            );
          })}
        </div>
        {needsPagination
         ? <div onClick={this.loadMore}>Next page</div>
        :null}
      </div>
    );

  }

});

export default Wrapper(TopicBody);
