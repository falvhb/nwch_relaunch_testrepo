import React from 'react';
import _ from 'lodash';

import getImageProps from 'helpers/get-image-props';
import getAssetMeta from 'helpers/get-asset-meta';

export default Component =>  React.createClass({

  displayName: 'ImageAssetWrapper',

  propTypes: {
    asset: React.PropTypes.object.isRequired,
    size: React.PropTypes.string.isRequired,
    ratio: React.PropTypes.string.isRequired,
    defer: React.PropTypes.bool,
    letterbox: React.PropTypes.bool,
    lazyload: React.PropTypes.bool
  },

  mappedData(props) {
    return {
      image: _.assign(getImageProps(props.asset), {
        size: props.size,
        ratio: props.ratio,
        defer: props.defer,
        letterbox: props.letterbox,
        lazyload: props.lazyload
      }),
      caption: getAssetMeta(props.asset)
    };
  },

  render() {
    return (
      <Component {...this.mappedData(this.props)} />
    );
  }

});
