/* eslint-disable no-unused-expressions */

import _ from 'lodash';

import getArticleUrl from 'helpers/get-article-url';
import fixture from 'utils/data/master-article';

import multipleRessorts from './data/multiple-ressorts';

import { expect } from 'chai';

describe('Helpers', () => {

  describe('getArticleUrl', () => {

    it('returns correct URL', () => {
      expect(getArticleUrl(fixture.article)).to.equal('/blaulicht/pferdekutsche-verursacht-einen-verkehrsunfall-7954160');
    });

    it('handles sub ressorts', () => {
      let data = _.assign({}, fixture.article);
      data.ressorts = multipleRessorts;
      expect(getArticleUrl(data)).to.equal('/kommentare/degen-sticht/pferdekutsche-verursacht-einen-verkehrsunfall-7954160');
    });

    it('handles ignore_for_canonical_url override', () => {
      let data = _.assign({}, fixture.article);
      data.ressorts = multipleRessorts;
      data.ressorts[0].ignore_for_canonical_url = true;
      let result = getArticleUrl(data);
      expect(result).to.equal('/kommentare/kommentar/pferdekutsche-verursacht-einen-verkehrsunfall-7954160');
    });

    it('handles no ressort parent', () => {
      let data = _.assign({}, fixture.article);
      data.ressorts = multipleRessorts;
      data.ressorts[0].ignore_for_canonical_url = true;
      data.ressorts[1].ignore_for_canonical_url = true;
      let result = getArticleUrl(data);
      expect(result).to.equal('/leben/pferdekutsche-verursacht-einen-verkehrsunfall-7954160');
    });

    it('handles manual_url override', () => {
      let data = _.assign({}, fixture.article);
      data.manual_url = 'Test manual URL';
      let result = getArticleUrl(data);
      expect(result).to.equal('/blaulicht/test-manual-url-7954160');
    });

    it('handles keyword_url override', () => {
      let data = _.assign({}, fixture.article);
      data.keyword_url = true;
      let result = getArticleUrl(data);
      expect(result).to.equal('/blaulicht/kutsche-unfall-7954160');
    });

    it('catches no title exception', () => {
      let data = _.assign({}, fixture.article);
      data.title = '';
      let result = getArticleUrl(data);
      expect(result).to.equal('#');
    });

    it('catches no id exception', () => {
      let data = _.assign({}, fixture.article);
      data.id = null;
      let result = getArticleUrl(data);
      expect(result).to.equal('#');
    });

  });

});
