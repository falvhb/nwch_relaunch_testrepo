import _ from 'lodash';
import getSource from 'helpers/get-source';

export default function(asset) {
  if (asset) {

    // get the image source based on asset type
    var mainImage = {
      asset_image: asset.image_url || (asset.asset ? asset.asset.image_url : null),
      asset_video: asset.asset.still_image ? (asset.asset.still_image.image_url || asset.asset.still_image.asset.image_url) : null,
      asset_image_gallery: asset.asset.images ? (asset.asset.images[0].image_url || asset.asset.images[0].asset.image_url) : null
    };

    // if we have a cover image
    if (mainImage[asset.asset.content_type]) {
      var title = asset.title || asset.asset.title;
      var alt = asset.description || asset.asset.description;
      var source = _.has(asset, 'asset.source') ? getSource(asset.asset.source) : '';

      return {
        src: mainImage[asset.asset.content_type],
        title: alt ? title : (source ? 'Â© ' + source : ''),
        alt: alt ? alt : title
      };
    }

    return null;
  }
}
