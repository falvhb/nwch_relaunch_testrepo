const Promise = require('es6-promise').Promise;

export default function(source, callback) {
  var script = document.createElement('script');
  var prior = document.getElementsByTagName('script')[0];
  script.async = 1;
  prior.parentNode.insertBefore(script, prior);

  return new Promise( function (resolve, reject) {
    script.onload = script.onreadystatechange = function( _, isAbort ) {
      if (isAbort || !script.readyState || /loaded|complete/.test(script.readyState) ) {
        script.onload = script.onreadystatechange = null;
        script = undefined;
        if (!isAbort) {
          resolve();
        } else {
          reject();
        }
      }
    };
    script.src = source;
  });
}
