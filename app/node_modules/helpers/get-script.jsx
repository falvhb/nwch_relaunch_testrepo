const Promise = require('es6-promise').Promise;

export default function(source, callback) {

  return new Promise(function (resolve, reject) {
    var script = document.createElement('script');
    var prior = document.getElementsByTagName('script')[0];
    script.type = 'text/javascript';
    script.async = true;
    script.src = source;

    script.onload = script.onreadystatechange = function() {
      if (!script.readyState || /loaded|complete/.test(script.readyState)) {
        script.onload = script.onreadystatechange = null;
        script.onerror = script.onabort = null;
        resolve(script);
      }
    };
    script.onerror = script.onabort = function () {
      script.onload = script.onreadystatechange = null;
      script.onerror = script.onabort = null;
      reject(new Error('Failed to load ' + script.src));
    };

    prior.parentNode.insertBefore(script, prior);
  });
}
