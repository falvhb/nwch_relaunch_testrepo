import _ from 'lodash';

import getName from 'helpers/user/get-name';

// Map title icons based on teaser labeltype
const titleIcons = {
  video: 'video',
  quiz: 'quiz',
  survey: 'survey',
  map: 'map',
  live: 'bullet',
  leserbeitrag: 'megaphone',
  vereinsmeldung: 'megaphone',
  sportverein: 'megaphone',
  gemeindebeitrag: 'megaphone'
};

// Map prefixes to theme type
const prefixes = {
  leserbeitrag: 'Leserbeitrag:',
  vereinsmeldung: 'Vereinsmeldung:',
  sportverein: 'Sportverein:',
  gemeindebeitrag: 'Gemeindebeitrag:'
};

// Map prefixes to teaser variation
const prefixedVariations = [
  'large'
];

// Map author suffixes based on teaser labeltype
const suffixes = [
  'meinung'
];

// Ignored decorations (prefix, icon, suffix) by teaser variation
const ignoredDecorationByVariation = [
  'quote',
  'author'
];

export default function(article, variation) {

  let labelType = _.get(article, 'labeltype');
  let user = _.get(article, 'author_detail.user');

  // test for and set prefix
  let needsPrefix = _.includes(prefixedVariations, variation) && !_.includes(ignoredDecorationByVariation, variation);
  let prefix = needsPrefix ? _.get(prefixes, labelType) : false;

  // test for and set suffix
  let needsSuffix = user && _.includes(suffixes, labelType) && !_.includes(ignoredDecorationByVariation, variation);
  let suffix = needsSuffix ? getName(user) : false;

  // test for and set icon
  let needsIcon = !_.includes(ignoredDecorationByVariation, variation);
  let icon = needsIcon ? _.get(titleIcons, labelType) : false;

  return {
    text: _.get(article, 'title'),
    icon: icon,
    prefix: prefix,
    suffix: suffix
  };
}
