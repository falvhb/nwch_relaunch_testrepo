import _ from 'lodash';
import path from 'path';

import getAvatar from 'helpers/user/get-avatar';

const prefix = process.env.STATIC_ASSETS || '/__node__/__static__/client';

export default function(article) {
  let user = _.get(article, 'author_detail.user');
  let imageProps = getAvatar(user);

  let imageConfig = {
    size: 'tiny',
    ratio: '1x1'
  };

  let fallback = {
    src: path.join(prefix, 'images', 'avatar-fallback.png'),
    alt: '',
    unresponsive: true // serve standard image
  };

  let returnedProps = imageProps
   ? _.extend({}, imageProps, imageConfig)
   : _.extend({}, fallback, imageConfig);

  return returnedProps;
}
