/* eslint-disable no-console */
import _ from 'lodash';
import Tracker from 'tracking/tracker';

const PAGEVIEW = 1;
const EVENT = 2;

export default {

  PAGEVIEW: PAGEVIEW,
  EVENT: EVENT,

  /**
   * Track certain events
   * @param data Object  Configuration object for the call.
   *                        Required fields: event, id, index
   */
  track(type, data) {
    let path,
        defaultData,
        processedData;

    path = window.location.pathname;

    // remove slashes at start and end
    path = path.replace(/^[\/]*/, '').replace(/[\/]*$/, '');

    defaultData = {
      domain: 'aznetz',
      path: {
        dummy: null,
        dummy2: '',
        product: 'live',
        sitename: this.props.site,
        view: this.constructor.displayName.toLowerCase(),
        path: path
      },
      referer: document.referer,
      screenWidth: screen.width,
      screenHeight: screen.height
    };
    processedData = _.extend(defaultData, {path: _.extend(defaultData.path, data)});

    // do the actual tracking
    if (type === this.EVENT) {
      Tracker.trackEvent(processedData);
    }

    if (type === this.PAGEVIEW) {
      Tracker.trackPageView(processedData);
    }

  }

};
