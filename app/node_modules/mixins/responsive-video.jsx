import jQuery from 'jquery';

export default {

  getVideoHeight(aspectRatio, width, playerControlsHeight) {
    return (width + aspectRatio * playerControlsHeight) / aspectRatio;
  },

  setupFixedRatioOnResizingVideo() {
    var self = this;
    var win = jQuery(window);

    win.on('resize.player-' + this.props.kaltura_id, function() {
      var domId = self.props.kaltura_id;
      var element = document.getElementById(domId);
      var playerControlsHeight = 35.8;
      var aspectRatio = 16 / 9;
      var width;
      var newHeight;

      // return if video element is not found
      if (!element) {
        return;
      }

      width = element.offsetWidth;
      newHeight = self.getVideoHeight(aspectRatio, width, playerControlsHeight);
      element.style.height = newHeight + 'px';
    });

    win.resize();
  },

  removeFixedRatioOnResizingVideo() {
    var win = jQuery(window);

    win.off('resize.player-'+this.props.kaltura_id);
  },

  componentWillUnmount() {
    this.removeFixedRatioOnResizingVideo();
  }
};
