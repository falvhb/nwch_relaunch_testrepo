'use strict';

const React = require('react');
const _ = require('lodash');

const Main = require('styleguide/main');
const Sidebar = require('styleguide/sidebar');
const Intro = require('styleguide/intro');
const Component = require('styleguide/component');

var Styleguide = React.createClass({

  // These are passed from server.js/browser.js
  propTypes: {
    components: React.PropTypes.array,
    component: React.PropTypes.oneOfType([
      React.PropTypes.string,
      React.PropTypes.bool
    ]),
    variation: React.PropTypes.oneOfType([
      React.PropTypes.string,
      React.PropTypes.bool
    ]),
  },

  findComponentBySlug(slug) {
    var props = this.props;
    return _.find(props.components, function(chr) {
      return chr.slug === slug;
    });
  },

  switchComponent(slug) {
    this.setState({
      component: this.findComponentBySlug(slug)
    });
  },

  getInitialState() {
    return {
      component: this.findComponentBySlug(this.props.component)
    };
  },

  render() {
    return (
      <div className='styleguide'>
        <Sidebar
          components={this.props.components}
          active={this.state.component}
          switchComponent={this.switchComponent}
        />
        <Main>
          {this.state.component ? <Component component={this.state.component}/> : <Intro/>}
        </Main>
      </div>
    );

  }

});

module.exports = Styleguide;
