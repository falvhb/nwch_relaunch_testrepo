'use strict';

const React = require('react');
const _ = require('lodash');

const SidebarSection = require('styleguide/sidebar-section');
const Logo = require('styleguide/logo');

const Sidebar = React.createClass({

  propTypes: {
    components: React.PropTypes.array.isRequired,
    active: React.PropTypes.string
  },

  uniqueSections(components) {
    var uniqComponents = _.uniq(components, 'category');
    return uniqComponents.map(function(component) {
      return component.category;
    });
  },

  render() {

    var components = this.props.components;
    var active = this.props.active;
    var sections = this.uniqueSections(components);

    var navigation = (
      <nav role="navigation">
        {sections.map(function(section, index) {
          var sectionComponents = _.filter(components, function(chr) {
            return chr.category === section;
          });
          return (
            <SidebarSection
              title={section}
              components={sectionComponents}
              active={active}
              key={index}
            />
          );
        })}
      </nav>
    );

    return (
      <header className='styleguide-sidebar'>
        <Logo />
        {navigation}
      </header>
    );
  }

});

module.exports = Sidebar;
