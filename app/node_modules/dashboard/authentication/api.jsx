import { pick } from 'lodash/object';
import axios from 'axios';

const LOGIN_URL = '/__api/v1/login';

// Place for translating
const messageTranslations = {
  unknown: 'Something went wrong but we don\'t know what'
};

const randomError = {
  errorMessage: messageTranslations['unknown'],
  submitting: false
}

export default {
  login(data, callback) {
    var fieldsToPost = pick(data, ['email', 'password']);

    axios.post(LOGIN_URL, fieldsToPost).then(function(response) {
      var data = response.data;
      if (data.error) {
        callback({
          errorMessage: messageTranslations[data.error] || data.error,
          submitting: false
        })
      } else if (data.status === "ok") {
        callback({
          authenticated: true,
          submitting: false
        })
      }
    });
  }
}
