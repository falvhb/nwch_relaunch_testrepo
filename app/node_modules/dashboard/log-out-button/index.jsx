import React from 'react';
import AuthenticationAPI from 'dashboard/authentication/api';
import Button from 'components/button';
import { History } from 'react-router';

export default React.createClass({
  displayName: 'LogoutButton',

  mixins: [History],

  getInitialState: () => ({
    busy: false
  }),

  onLogoutClick() {
    this.setState({
      busy: true
    }, () => AuthenticationAPI.logout(this.onLogoutComplete));
  },

  onLogoutComplete(result) {
    if (result) {
      document.location = '/';
    } else {
      this.setState({
        busy: false
      });
    }
  },

  render() {
    return (
      <Button
        modifier="small"
        _event={ this.onLogoutClick }
        label="Abmelden"
        attributes={{
          disabled: this.state.busy,
        }}
      />
    );
  }

});
