/*eslint no-else-return: 0*/

import React from 'react';
import { cut } from 'legacy/helpers/textfmt';

/*
<metal:macro define-macro="ArticleAnriss">

  <tal:cond tal:condition="view/anriss">
    <div class="box anriss"
         onclick=""
         tal:content="structure view/anriss"
         tal:attributes="onclick string:javascript:window.location.href='${context/@@absolute_url}'">
      Article teaser text.
    </div>
  </tal:cond>

  <tal:else tal:condition="not:view/anriss">

    <tal:cond tal:condition="view/isUgcArticle">

      <div tal:condition="view/providesTeaserCompatibleMainAsset"
           class="box anriss"
           onclick=""
           tal:content="structure textfmt:view/text?clear_html=&amp;allow_all=&amp;cut=150:1:...mehr"
           tal:attributes="onclick string:javascript:window.location.href='${context/@@absolute_url}'">
        Article pseudo teaser text.
      </div>
      <div tal:condition="not:view/providesTeaserCompatibleMainAsset"
           class="box anriss"
           onclick=""
           tal:content="structure textfmt:view/text?clear_html=&amp;allow_all=&amp;cut=300:1:...mehr"
           tal:attributes="onclick string:javascript:window.location.href='${context/@@absolute_url}'">
        Article pseudo teaser text.
      </div>
    </tal:cond>

  </tal:else>
</metal:macro>
*/

export default class ArticleAnriss extends React.Component {

  render() {

    const { view } = this.props;
    const absoluteUrl = view.getAbsoluteUrl();

    if (view.anriss) {
      return (
        <div dangerouslySetInnerHTML={{__html: `<div class="box anriss" onclick="javascript:window.location.href='${absoluteUrl}'">
          ${view.anriss}
        </div>`}} />
      );
    } else if (view.isUgcArticle) {
      if (view.providesTeaserCompatibleMainAsset) {
        return (
          <div dangerouslySetInnerHTML={{__html: `<div class="box anriss" onclick="javascript:window.location.href='${absoluteUrl}'">
            ${cut(view.text, { cutLen: 150, softcut: true, fill: '...mehr' } )}
          </div>`}} />
        );
      } else {
        return (
          <div dangerouslySetInnerHTML={{__html: `<div class="box anriss" onclick="javascript:window.location.href='${absoluteUrl}'">
            ${cut(view.text, { cutLen: 300, softcut: true, fill: '...mehr' } )}
          </div>`}} />
        );
      }
    }

    // might happen ...
    return null;

  }
}
